import hashlib
import time

FILE_PATH = "D:\\Cerberus\\qt\\Cerberus\\build\\Desktop_Qt_6_7_2_MinGW_64_bit-Debug\\debug\\master_password.ini"
WORD_LIST_PATH = "D:\\Cerberus\\qt\\Cerberus\\hash_hack.txt"

hashedFile = open(FILE_PATH, "r")

hashedPass = hashedFile.read()
hashedPass = hashedPass[29:len(hashedPass)]
print(f"Hashed password = {hashedPass}")

with open(WORD_LIST_PATH, "r") as wordListFile:
    wordList = wordListFile.read()
    words = wordList.split()

for word in words:
    hashed_word = hashlib.sha256(word.encode('utf-8')).hexdigest()
    if hashed_word.strip() == hashedPass.strip():
        print("======PASSWORD CRACKED======")
        print(f"User's password - {word}")
        break
    else:
        print(f"Password {word} is incorrect!")
        time.sleep(1)
print("======END OF PROGRAMM======")
hashedFile.close()